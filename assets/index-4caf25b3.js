(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))t(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const y of s.addedNodes)y.tagName==="LINK"&&y.rel==="modulepreload"&&t(y)}).observe(document,{childList:!0,subtree:!0});function r(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function t(n){if(n.ep)return;n.ep=!0;const s=r(n);fetch(n.href,s)}})();(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))r(t);new MutationObserver(t=>{for(const n of t)if(n.type==="childList")for(const s of n.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function e(t){const n={};return t.integrity&&(n.integrity=t.integrity),t.referrerPolicy&&(n.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?n.credentials="include":t.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(t){if(t.ep)return;t.ep=!0;const n=e(t);fetch(t.href,n)}})();const w="test",$="https://content.guardianapis.com";console.log("Entorno de ejecución:",window.location.href);console.log("Base URL:",document.baseURI);window.addEventListener("DOMContentLoaded",function(){const o=window.location.href.includes("github.io");console.log("Ejecutando en GitHub Pages:",o),o&&document.body.classList.add("github-pages")});let l=1,g="",f="",b=!1,L=!0,a,u,h,i,d,m,c;document.addEventListener("DOMContentLoaded",()=>{if(console.log("DOM cargado, inicializando aplicación..."),x(),!a||!u||!h||!i||!m||!c){console.error("No se pudieron encontrar todos los elementos DOM necesarios"),v("Error: No se pudieron encontrar todos los elementos necesarios en la página.");return}console.log("DOM cargado completamente, iniciando aplicación..."),p(),N()});function x(){console.log("Inicializando referencias DOM..."),a=document.getElementById("news-container"),u=document.getElementById("search-input"),h=document.getElementById("search-button"),i=document.getElementById("load-more"),d=document.querySelectorAll(".category-link"),m=document.getElementById("loading-indicator"),c=document.getElementById("error-container"),console.log("news-container encontrado:",!!a),console.log("search-input encontrado:",!!u),console.log("search-button encontrado:",!!h),console.log("load-more encontrado:",!!i),console.log("category-links encontrados:",d==null?void 0:d.length),console.log("loading-indicator encontrado:",!!m),console.log("error-container encontrado:",!!c)}function v(o){console.error(o);const e=document.createElement("div");e.style.backgroundColor="#f8d7da",e.style.color="#721c24",e.style.padding="1rem",e.style.margin="1rem",e.style.borderRadius="0.25rem",e.style.border="1px solid #f5c6cb",e.textContent=o;const r=document.querySelector("main")||document.body;r.insertBefore(e,r.firstChild)}function N(){console.log("Configurando event listeners...");try{h.addEventListener("click",E),u.addEventListener("keypress",o=>{o.key==="Enter"&&E()}),d.forEach(o=>{o.addEventListener("click",e=>{e.preventDefault();const r=e.target.closest("a").dataset.category;O(r)})}),i.addEventListener("click",()=>{l++,p(!1)}),console.log("Event listeners configurados correctamente")}catch(o){console.error("Error al configurar event listeners:",o),v(`Error al configurar la interactividad: ${o.message}`)}}function O(o){console.log(`Cambiando a categoría: ${o}`),d.forEach(e=>{e.dataset.category===o?(e.classList.add("active-category"),e.setAttribute("aria-current","page")):(e.classList.remove("active-category"),e.removeAttribute("aria-current"))}),g=o,f="",l=1,u.value="",a.innerHTML="",p()}function E(){const o=u.value.trim();o&&(console.log(`Buscando: ${o}`),f=o,g="",l=1,a.innerHTML="",d.forEach(e=>{e.classList.remove("active-category"),e.removeAttribute("aria-current")}),p())}async function p(o=!0){if(!b){b=!0,c.classList.add("hidden"),m.classList.remove("hidden"),i.classList.add("hidden");try{console.log(`Obteniendo noticias - Página: ${l}, Categoría: ${g||"todas"}, Búsqueda: ${f||"ninguna"}`);let e=`${$}/search?api-key=${w}&show-fields=headline,trailText,thumbnail,shortUrl&page=${l}&page-size=10`;f&&(e+=`&q=${encodeURIComponent(f)}`),g&&(e+=`&section=${g}`),console.log(`URL de la API: ${e}`);const r=await fetch(e);if(console.log("Estado de la respuesta:",r.status,r.statusText),!r.ok)throw new Error(`Error HTTP: ${r.status} - ${r.statusText}`);const t=await r.json();if(console.log("Datos recibidos de la API:",t?"Sí":"No"),!t||!t.response||!t.response.results)throw console.error("Estructura de datos inesperada:",t),new Error("Formato de respuesta de API inesperado");const n=t.response.results;console.log(`Artículos recibidos: ${n.length}`),L=l<t.response.pages,o&&(a.innerHTML=""),P(n),L?i.classList.remove("hidden"):i.classList.add("hidden")}catch(e){console.error("Error al obtener noticias:",e),I(`No pudimos cargar las noticias: ${e.message}. Por favor, intenta de nuevo más tarde.`)}finally{b=!1,m.classList.add("hidden")}}}function P(o){if(console.log("Renderizando artículos..."),o.length===0){a.innerHTML=`
      <div class="p-4 text-center">
        <p class="text-gray-600">No se encontraron noticias que coincidan con tu búsqueda.</p>
      </div>
    `;return}o.forEach((e,r)=>{console.log(`Renderizando artículo ${r+1}/${o.length}`);const t=e.fields||{},n=document.createElement("article");n.className="news-article bg-white rounded-lg shadow-md overflow-hidden mb-6 transition-transform duration-300 hover:shadow-lg hover:-translate-y-1",n.setAttribute("role","article"),t.thumbnail,n.innerHTML=`
      <div class="md:flex">
        <div class="md:w-1/3 relative">
          ${t.thumbnail?`<img src="${t.thumbnail}" alt="${t.headline||"Noticia"}" class="h-48 w-full object-cover" loading="lazy">`:'<div class="h-48 w-full bg-gray-200 flex items-center justify-center"><span class="text-gray-400">No image available</span></div>'}
        </div>
        <div class="p-4 md:w-2/3">
          <h2 class="text-xl font-bold mb-2">
            <a href="${t.shortUrl||"#"}" target="_blank" rel="noopener noreferrer" class="text-blue-700 hover:text-blue-900 focus:outline-none focus:underline" aria-label="${t.headline||"Noticia"}">
              ${t.headline||"Título no disponible"}
            </a>
          </h2>
          <p class="text-gray-700 mb-4">${t.trailText||"No description available"}</p>
          <div class="flex justify-between items-center">
            <span class="text-sm text-gray-500">${M(e.webPublicationDate)}</span>
            <a href="${t.shortUrl||"#"}" target="_blank" rel="noopener noreferrer" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50" aria-label="Read more about ${t.headline||"esta noticia"}">
              Leer más
            </a>
          </div>
        </div>
      </div>
    `,a.appendChild(n)}),console.log("Artículos renderizados correctamente")}function I(o){console.error(`Error: ${o}`),c?(c.textContent=o,c.classList.remove("hidden")):v(o)}function M(o){if(!o)return"Fecha no disponible";try{const e={year:"numeric",month:"long",day:"numeric"};return new Date(o).toLocaleDateString("es-ES",e)}catch(e){return console.error("Error al formatear fecha:",e),o}}
