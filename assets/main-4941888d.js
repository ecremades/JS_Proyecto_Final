(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))r(t);new MutationObserver(t=>{for(const a of t)if(a.type==="childList")for(const b of a.addedNodes)b.tagName==="LINK"&&b.rel==="modulepreload"&&r(b)}).observe(document,{childList:!0,subtree:!0});function n(t){const a={};return t.integrity&&(a.integrity=t.integrity),t.referrerPolicy&&(a.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?a.credentials="include":t.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(t){if(t.ep)return;t.ep=!0;const a=n(t);fetch(t.href,a)}})();const w="test",$="https://content.guardianapis.com";console.log("Entorno de ejecución:",window.location.href);console.log("Base URL:",document.baseURI);window.addEventListener("DOMContentLoaded",function(){const o=window.location.href.includes("github.io");console.log("Ejecutando en GitHub Pages:",o),o&&document.body.classList.add("github-pages")});let d=1,g="",f="",y=!1,E=!0,s,u,h,c,i,m,l;document.addEventListener("DOMContentLoaded",()=>{if(console.log("DOM cargado, inicializando aplicación..."),x(),!s||!u||!h||!c||!m||!l){console.error("No se pudieron encontrar todos los elementos DOM necesarios"),v("Error: No se pudieron encontrar todos los elementos necesarios en la página.");return}console.log("DOM cargado completamente, iniciando aplicación..."),p(),I()});function x(){console.log("Inicializando referencias DOM..."),s=document.getElementById("news-container"),u=document.getElementById("search-input"),h=document.getElementById("search-button"),c=document.getElementById("load-more"),i=document.querySelectorAll(".category-link"),m=document.getElementById("loading-indicator"),l=document.getElementById("error-container"),console.log("news-container encontrado:",!!s),console.log("search-input encontrado:",!!u),console.log("search-button encontrado:",!!h),console.log("load-more encontrado:",!!c),console.log("category-links encontrados:",i==null?void 0:i.length),console.log("loading-indicator encontrado:",!!m),console.log("error-container encontrado:",!!l)}function v(o){console.error(o);const e=document.createElement("div");e.style.backgroundColor="#f8d7da",e.style.color="#721c24",e.style.padding="1rem",e.style.margin="1rem",e.style.borderRadius="0.25rem",e.style.border="1px solid #f5c6cb",e.textContent=o;const n=document.querySelector("main")||document.body;n.insertBefore(e,n.firstChild)}function I(){console.log("Configurando event listeners...");try{h.addEventListener("click",L),u.addEventListener("keypress",o=>{o.key==="Enter"&&L()}),i.forEach(o=>{o.addEventListener("click",e=>{e.preventDefault();const n=e.target.closest("a").dataset.category;P(n)})}),c.addEventListener("click",()=>{d++,p(!1)}),console.log("Event listeners configurados correctamente")}catch(o){console.error("Error al configurar event listeners:",o),v(`Error al configurar la interactividad: ${o.message}`)}}function P(o){console.log(`Cambiando a categoría: ${o}`),i.forEach(e=>{e.dataset.category===o?(e.classList.add("active-category"),e.setAttribute("aria-current","page")):(e.classList.remove("active-category"),e.removeAttribute("aria-current"))}),g=o,f="",d=1,u.value="",s.innerHTML="",p()}function L(){const o=u.value.trim();o&&(console.log(`Buscando: ${o}`),f=o,g="",d=1,s.innerHTML="",i.forEach(e=>{e.classList.remove("active-category"),e.removeAttribute("aria-current")}),p())}async function p(o=!0){if(!y){y=!0,l.classList.add("hidden"),m.classList.remove("hidden"),c.classList.add("hidden");try{console.log(`Obteniendo noticias - Página: ${d}, Categoría: ${g||"todas"}, Búsqueda: ${f||"ninguna"}`);let e=`${$}/search?api-key=${w}&show-fields=headline,trailText,thumbnail,shortUrl&page=${d}&page-size=10`;f&&(e+=`&q=${encodeURIComponent(f)}`),g&&(e+=`&section=${g}`),console.log(`URL de la API: ${e}`);const n=await fetch(e);if(console.log("Estado de la respuesta:",n.status,n.statusText),!n.ok)throw new Error(`Error HTTP: ${n.status} - ${n.statusText}`);const r=await n.json();if(console.log("Datos recibidos de la API:",r?"Sí":"No"),!r||!r.response||!r.response.results)throw console.error("Estructura de datos inesperada:",r),new Error("Formato de respuesta de API inesperado");const t=r.response.results;console.log(`Artículos recibidos: ${t.length}`),E=d<r.response.pages,o&&(s.innerHTML=""),C(t),E?c.classList.remove("hidden"):c.classList.add("hidden")}catch(e){console.error("Error al obtener noticias:",e),M(`No pudimos cargar las noticias: ${e.message}. Por favor, intenta de nuevo más tarde.`)}finally{y=!1,m.classList.add("hidden")}}}function C(o){if(console.log("Renderizando artículos..."),o.length===0){s.innerHTML=`
      <div class="p-4 text-center">
        <p class="text-gray-600">No se encontraron noticias que coincidan con tu búsqueda.</p>
      </div>
    `;return}o.forEach((e,n)=>{console.log(`Renderizando artículo ${n+1}/${o.length}`);const r=e.fields||{},t=document.createElement("article");t.className="news-article bg-white rounded-lg shadow-md overflow-hidden mb-6 transition-transform duration-300 hover:shadow-lg hover:-translate-y-1",t.setAttribute("role","article"),r.thumbnail,t.innerHTML=`
      <div class="md:flex">
        <div class="md:w-1/3 relative">
          ${r.thumbnail?`<img src="${r.thumbnail}" alt="${r.headline||"Noticia"}" class="h-48 w-full object-cover" loading="lazy">`:'<div class="h-48 w-full bg-gray-200 flex items-center justify-center"><span class="text-gray-400">No image available</span></div>'}
        </div>
        <div class="p-4 md:w-2/3">
          <h2 class="text-xl font-bold mb-2">
            <a href="${r.shortUrl||"#"}" target="_blank" rel="noopener noreferrer" class="text-blue-700 hover:text-blue-900 focus:outline-none focus:underline" aria-label="${r.headline||"Noticia"}">
              ${r.headline||"Título no disponible"}
            </a>
          </h2>
          <p class="text-gray-700 mb-4">${r.trailText||"No description available"}</p>
          <div class="flex justify-between items-center">
            <span class="text-sm text-gray-500">${N(e.webPublicationDate)}</span>
            <a href="${r.shortUrl||"#"}" target="_blank" rel="noopener noreferrer" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50" aria-label="Read more about ${r.headline||"esta noticia"}">
              Leer más
            </a>
          </div>
        </div>
      </div>
    `,s.appendChild(t)}),console.log("Artículos renderizados correctamente")}function M(o){console.error(`Error: ${o}`),l?(l.textContent=o,l.classList.remove("hidden")):v(o)}function N(o){if(!o)return"Fecha no disponible";try{const e={year:"numeric",month:"long",day:"numeric"};return new Date(o).toLocaleDateString("es-ES",e)}catch(e){return console.error("Error al formatear fecha:",e),o}}
